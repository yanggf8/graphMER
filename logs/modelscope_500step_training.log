Data sources: {'code': {'licenses_allow': ['MIT', 'Apache-2.0', 'BSD-2-Clause', 'BSD-3-Clause', 'MPL-2.0'], 'languages': ['python', 'java'], 'provenance_fields': ['repo', 'commit', 'file', 'span', 'license'], 'repo_allowlist': {'python': ['requests/requests', 'psf/requests', 'pallets/flask', 'django/django', 'numpy/numpy', 'scipy/scipy', 'scikit-learn/scikit-learn', 'pandas-dev/pandas', 'python/cpython', 'pytest-dev/pytest', 'pallets/click', 'encode/httpx', 'pydantic/pydantic', 'fastapi/fastapi', 'sqlalchemy/sqlalchemy'], 'java': ['spring-projects/spring-boot', 'spring-projects/spring-framework', 'apache/commons-lang', 'google/guava', 'junit-team/junit5', 'mockito/mockito', 'apache/maven', 'gradle/gradle', 'elastic/elasticsearch', 'apache/kafka', 'ReactiveX/RxJava', 'square/okhttp', 'google/gson', 'FasterXML/jackson-core', 'apache/commons-io']}}, 'docs': {'types': ['readme', 'api_docs', 'adr']}}
Triples schema: {'head': {'id': 'string', 'type': 'string'}, 'relation': {'type': 'string'}, 'tail': {'id': 'string', 'type': 'string'}, 'qualifiers': {'language': 'string', 'repo': 'string', 'commit': 'string', 'file': 'string', 'span': {'start': 'int', 'end': 'int'}, 'license': 'string'}}
Discovered 217 Python files
Wrote: data/kg/seed_python.jsonl
Validation: {'domain_range_ok': 28996, 'total_triples': 29174, 'domain_range_ratio': 0.9938986769040927, 'inherits_acyclic': True, 'failures_preview': [{'triple': {'head': 'config.Settings.__init__', 'relation': 'catches', 'tail': 'config.ConfigError', 'qualifiers': {'language': 'python', 'file': 'data/raw/python_samples/config.py', 'module': 'config'}}, 'reason': 'domain_range_mismatch', 'expected_domain': ['Method', 'Function'], 'expected_range': ['ExceptionType'], 'head_type': 'Method', 'tail_type': 'Class'}, {'triple': {'head': 'dataframe.read_json', 'relation': 'instantiates', 'tail': 'dataframe.ValueError', 'qualifiers': {'language': 'python', 'file': 'data/raw/python_samples/dataframe.py', 'module': 'dataframe'}}, 'reason': 'domain_range_mismatch', 'expected_domain': ['Method', 'Function'], 'expected_range': ['Class'], 'head_type': 'Function', 'tail_type': 'ExceptionType'}, {'triple': {'head': 'flask.HTTPException', 'relation': 'inherits_from', 'tail': 'flask.Exception', 'qualifiers': {'language': 'python', 'file': 'data/raw/python_samples/flask.py', 'module': 'flask'}}, 'reason': 'domain_range_mismatch', 'expected_domain': ['Class'], 'expected_range': ['Class'], 'head_type': 'Class', 'tail_type': 'ExceptionType'}, {'triple': {'head': 'pkg_101__optional.import_optional_dependency', 'relation': 'catches', 'tail': 'pkg_101__optional.ImportError', 'qualifiers': {'language': 'python', 'file': 'data/raw/python_samples/pip/pkg_101__optional.py', 'module': 'pkg_101__optional'}}, 'reason': 'domain_range_mismatch', 'expected_domain': ['Method', 'Function'], 'expected_range': ['ExceptionType'], 'head_type': 'Function', 'tail_type': 'Class'}, {'triple': {'head': 'pkg_102_compressors', 'relation': 'catches', 'tail': 'pkg_102_compressors.ImportError', 'qualifiers': {'language': 'python', 'file': 'data/raw/python_samples/pip/pkg_102_compressors.py', 'module': 'pkg_102_compressors'}}, 'reason': 'domain_range_mismatch', 'expected_domain': ['Method', 'Function'], 'expected_range': ['ExceptionType'], 'head_type': 'Module', 'tail_type': 'ExceptionType'}, {'triple': {'head': 'pkg_102_compressors', 'relation': 'catches', 'tail': 'pkg_102_compressors.ImportError', 'qualifiers': {'language': 'python', 'file': 'data/raw/python_samples/pip/pkg_102_compressors.py', 'module': 'pkg_102_compressors'}}, 'reason': 'domain_range_mismatch', 'expected_domain': ['Method', 'Function'], 'expected_range': ['ExceptionType'], 'head_type': 'Module', 'tail_type': 'ExceptionType'}, {'triple': {'head': 'pkg_104_pyarrow', 'relation': 'catches', 'tail': 'pkg_104_pyarrow.ImportError', 'qualifiers': {'language': 'python', 'file': 'data/raw/python_samples/pip/pkg_104_pyarrow.py', 'module': 'pkg_104_pyarrow'}}, 'reason': 'domain_range_mismatch', 'expected_domain': ['Method', 'Function'], 'expected_range': ['ExceptionType'], 'head_type': 'Module', 'tail_type': 'ExceptionType'}, {'triple': {'head': 'pkg_105___init__', 'relation': 'catches', 'tail': 'pkg_105___init__.AttributeError', 'qualifiers': {'language': 'python', 'file': 'data/raw/python_samples/pip/pkg_105___init__.py', 'module': 'pkg_105___init__'}}, 'reason': 'domain_range_mismatch', 'expected_domain': ['Method', 'Function'], 'expected_range': ['ExceptionType'], 'head_type': 'Module', 'tail_type': 'ExceptionType'}, {'triple': {'head': 'pkg_109_arraylike._reconstruct', 'relation': 'raises', 'tail': 'pkg_109_arraylike.NotImplementedError', 'qualifiers': {'language': 'python', 'file': 'data/raw/python_samples/pip/pkg_109_arraylike.py', 'module': 'pkg_109_arraylike'}}, 'reason': 'domain_range_mismatch', 'expected_domain': ['Method', 'Function'], 'expected_range': ['ExceptionType'], 'head_type': 'Function', 'tail_type': 'Class'}, {'triple': {'head': 'pkg_109_arraylike.dispatch_ufunc_with_out', 'relation': 'raises', 'tail': 'pkg_109_arraylike.NotImplementedError', 'qualifiers': {'language': 'python', 'file': 'data/raw/python_samples/pip/pkg_109_arraylike.py', 'module': 'pkg_109_arraylike'}}, 'reason': 'domain_range_mismatch', 'expected_domain': ['Method', 'Function'], 'expected_range': ['ExceptionType'], 'head_type': 'Function', 'tail_type': 'Class'}]}
Loaded training config keys: ['run', 'hardware', 'model', 'optimizer', 'training_data', 'objectives', 'encoding', 'regularizers', 'checkpointing', 'notes']
Using random seed: 42
Updated ablation metadata at ablation_metadata.json
Using KG-backed dataset with 100 samples.
Vocab size: 339
step 10: total_loss=0.3754, mlm_loss=5.9779, mnm_loss=6.0338
val_acc: mlm_accuracy=0.0000, mnm_accuracy=0.0000
step 20: total_loss=0.3818, mlm_loss=6.1225, mnm_loss=6.0937
val_acc: mlm_accuracy=0.0000, mnm_accuracy=0.0000
step 30: total_loss=0.3793, mlm_loss=6.1041, mnm_loss=6.0343
val_acc: mlm_accuracy=0.0000, mnm_accuracy=0.0000
step 40: total_loss=0.3414, mlm_loss=5.3082, mnm_loss=5.6180
val_acc: mlm_accuracy=0.0000, mnm_accuracy=0.0000
step 50: total_loss=0.3587, mlm_loss=5.4635, mnm_loss=6.0141
val_acc: mlm_accuracy=0.0909, mnm_accuracy=0.0385
step 60: total_loss=0.3460, mlm_loss=5.3736, mnm_loss=5.6994
val_acc: mlm_accuracy=0.0000, mnm_accuracy=0.0741
step 70: total_loss=0.3225, mlm_loss=5.0651, mnm_loss=5.2561
val_acc: mlm_accuracy=0.2222, mnm_accuracy=0.2105
step 80: total_loss=0.3300, mlm_loss=5.1051, mnm_loss=5.4562
val_acc: mlm_accuracy=0.2000, mnm_accuracy=0.1053
step 90: total_loss=0.3218, mlm_loss=4.9970, mnm_loss=5.3014
val_acc: mlm_accuracy=0.0909, mnm_accuracy=0.2308
step 100: total_loss=0.3057, mlm_loss=4.5084, mnm_loss=5.2746
val_acc: mlm_accuracy=0.3333, mnm_accuracy=0.1250
step 110: total_loss=0.3135, mlm_loss=4.6904, mnm_loss=5.3405
val_acc: mlm_accuracy=0.2500, mnm_accuracy=0.2143
step 120: total_loss=0.3027, mlm_loss=4.6994, mnm_loss=4.9855
val_acc: mlm_accuracy=0.3000, mnm_accuracy=0.0909
step 130: total_loss=0.2831, mlm_loss=4.1224, mnm_loss=4.9383
val_acc: mlm_accuracy=0.2500, mnm_accuracy=0.1364
step 140: total_loss=0.3016, mlm_loss=4.4080, mnm_loss=5.2447
val_acc: mlm_accuracy=0.2500, mnm_accuracy=0.0556
step 150: total_loss=0.2930, mlm_loss=4.3932, mnm_loss=4.9843
val_acc: mlm_accuracy=0.3333, mnm_accuracy=0.0952
step 160: total_loss=0.2821, mlm_loss=4.3798, mnm_loss=4.6472
val_acc: mlm_accuracy=0.5000, mnm_accuracy=0.2727
step 170: total_loss=0.2882, mlm_loss=3.9478, mnm_loss=5.2738
val_acc: mlm_accuracy=0.4167, mnm_accuracy=0.2222
step 180: total_loss=0.2931, mlm_loss=4.1403, mnm_loss=5.2401
val_acc: mlm_accuracy=0.5556, mnm_accuracy=0.0769
step 190: total_loss=0.2750, mlm_loss=3.4448, mnm_loss=5.3553
val_acc: mlm_accuracy=0.2727, mnm_accuracy=0.1250
step 200: total_loss=0.2808, mlm_loss=3.8383, mnm_loss=5.1488
val_acc: mlm_accuracy=0.4167, mnm_accuracy=0.3226
step 210: total_loss=0.2715, mlm_loss=4.2432, mnm_loss=4.4433
val_acc: mlm_accuracy=0.6364, mnm_accuracy=0.2400
step 220: total_loss=0.2683, mlm_loss=4.0147, mnm_loss=4.5715
val_acc: mlm_accuracy=0.5000, mnm_accuracy=0.0811
step 230: total_loss=0.2752, mlm_loss=3.9189, mnm_loss=4.8865
val_acc: mlm_accuracy=0.5000, mnm_accuracy=0.2083
step 240: total_loss=0.2666, mlm_loss=3.6327, mnm_loss=4.8973
val_acc: mlm_accuracy=0.5000, mnm_accuracy=0.2857
step 250: total_loss=0.2452, mlm_loss=3.0741, mnm_loss=4.7709
val_acc: mlm_accuracy=0.4545, mnm_accuracy=0.1923
step 260: total_loss=0.2501, mlm_loss=3.1593, mnm_loss=4.8448
val_acc: mlm_accuracy=0.5000, mnm_accuracy=0.2963
step 270: total_loss=0.2547, mlm_loss=2.7851, mnm_loss=5.3657
val_acc: mlm_accuracy=0.5556, mnm_accuracy=0.2632
step 280: total_loss=0.2461, mlm_loss=3.0658, mnm_loss=4.8081
val_acc: mlm_accuracy=0.5000, mnm_accuracy=0.2632
step 290: total_loss=0.2406, mlm_loss=3.4209, mnm_loss=4.2790
val_acc: mlm_accuracy=0.7273, mnm_accuracy=0.2308
step 300: total_loss=0.2571, mlm_loss=3.6842, mnm_loss=4.5431
val_acc: mlm_accuracy=0.6667, mnm_accuracy=0.1250
step 310: total_loss=0.2379, mlm_loss=3.1517, mnm_loss=4.4601
val_acc: mlm_accuracy=0.5833, mnm_accuracy=0.2857
step 320: total_loss=0.2420, mlm_loss=3.1929, mnm_loss=4.5497
val_acc: mlm_accuracy=0.5000, mnm_accuracy=0.1364
step 330: total_loss=0.2366, mlm_loss=3.2740, mnm_loss=4.2961
val_acc: mlm_accuracy=0.4167, mnm_accuracy=0.1818
step 340: total_loss=0.2336, mlm_loss=3.2276, mnm_loss=4.2461
val_acc: mlm_accuracy=0.7500, mnm_accuracy=0.0556
step 350: total_loss=0.2288, mlm_loss=3.2628, mnm_loss=4.0588
val_acc: mlm_accuracy=0.6667, mnm_accuracy=0.0952
step 360: total_loss=0.2356, mlm_loss=3.2686, mnm_loss=4.2716
val_acc: mlm_accuracy=0.5833, mnm_accuracy=0.2727
step 370: total_loss=0.2161, mlm_loss=3.0465, mnm_loss=3.8682
val_acc: mlm_accuracy=0.5000, mnm_accuracy=0.2593
step 380: total_loss=0.2101, mlm_loss=2.1982, mnm_loss=4.5254
val_acc: mlm_accuracy=0.7778, mnm_accuracy=0.1154
step 390: total_loss=0.2128, mlm_loss=1.8301, mnm_loss=4.9790
val_acc: mlm_accuracy=0.6364, mnm_accuracy=0.1250
step 400: total_loss=0.2228, mlm_loss=2.6150, mnm_loss=4.5160
val_acc: mlm_accuracy=0.4167, mnm_accuracy=0.3226
step 410: total_loss=0.2140, mlm_loss=2.9000, mnm_loss=3.9482
val_acc: mlm_accuracy=0.7273, mnm_accuracy=0.2400
step 420: total_loss=0.2200, mlm_loss=2.4805, mnm_loss=4.5603
val_acc: mlm_accuracy=0.6000, mnm_accuracy=0.1081
step 430: total_loss=0.1988, mlm_loss=2.0333, mnm_loss=4.3271
val_acc: mlm_accuracy=0.7000, mnm_accuracy=0.2083
step 440: total_loss=0.2274, mlm_loss=2.6006, mnm_loss=4.6768
val_acc: mlm_accuracy=0.5000, mnm_accuracy=0.2857
step 450: total_loss=0.2018, mlm_loss=2.7432, mnm_loss=3.7129
val_acc: mlm_accuracy=0.4545, mnm_accuracy=0.2308
step 460: total_loss=0.2234, mlm_loss=3.0802, mnm_loss=4.0671
val_acc: mlm_accuracy=0.7500, mnm_accuracy=0.2963
step 470: total_loss=0.2380, mlm_loss=3.3300, mnm_loss=4.2867
val_acc: mlm_accuracy=0.6667, mnm_accuracy=0.2105
step 480: total_loss=0.2003, mlm_loss=2.9216, mnm_loss=3.4873
val_acc: mlm_accuracy=0.5000, mnm_accuracy=0.2632
step 490: total_loss=0.2071, mlm_loss=2.1804, mnm_loss=4.4455
val_acc: mlm_accuracy=0.8182, mnm_accuracy=0.2692
step 500: total_loss=0.2076, mlm_loss=2.3399, mnm_loss=4.3040
val_acc: mlm_accuracy=0.6667, mnm_accuracy=0.1667
Smoke training finished.
